'\" t
.\" Automatically generated by Pandoc 2.17.0.1
.\"
.TH "chkdsk" 1 "" "" "" ""
.hy
.SH chkdsk
.PP
Checks the file system and file system metadata of a volume for logical
and physical errors.
If used without parameters, \f[B]chkdsk\f[R] displays only the status of
the volume and does not fix any errors.
If used with the \f[B]/f\f[R], \f[B]/r\f[R], \f[B]/x\f[R], or
\f[B]/b\f[R] parameters, it fixes errors on the volume.
.RS
.PP
[!IMPORTANT] Membership in the local \f[B]Administrators\f[R] group, or
equivalent, is the minimum required to run \f[B]chkdsk\f[R].
To open a command prompt window as an administrator, right-click
\f[B]Command prompt\f[R] in the \f[B]Start\f[R] menu, and then click
\f[B]Run as administrator\f[R].
.RE
.RS
.PP
[!IMPORTANT] Interrupting \f[B]chkdsk\f[R] is not recommended.
However, canceling or interrupting \f[B]chkdsk\f[R] should not leave the
volume any more corrupt than it was before \f[B]chkdsk\f[R] was run.
Running \f[B]chkdsk\f[R] again checks and should repair any remaining
corruption on the volume.
.RE
.RS
.PP
[!NOTE] Chkdsk can be used only for local disks.
The command cannot be used with a local drive letter that has been
redirected over the network.
.RE
.SS Syntax
.IP
.nf
\f[C]
chkdsk [<volume>[[<path>]<filename>]] [/f] [/v] [/r] [/x] [/i] [/c] [/l[:<size>]] [/b]
\f[R]
.fi
.SS Parameters
.PP
.TS
tab(@);
lw(31.5n) lw(38.5n).
T{
Parameter
T}@T{
Description
T}
_
T{
\f[C]<volume>\f[R]
T}@T{
Specifies the drive letter (followed by a colon), mount point, or volume
name.
T}
T{
[ \f[C][<path>]<filename>\f[R]
T}@T{
Use with file allocation table (FAT) and FAT32 only.
Specifies the location and name of a file or set of files that you want
\f[B]chkdsk\f[R] to check for fragmentation.
You can use the \f[B]?\f[R] and \f[B]*\f[R] wildcard characters to
specify multiple files.
T}
T{
/f
T}@T{
Fixes errors on the disk.
The disk must be locked.
If \f[B]chkdsk\f[R] cannot lock the drive, a message appears that asks
you if you want to check the drive the next time you restart the
computer.
T}
T{
/v
T}@T{
Displays the name of each file in every directory as the disk is
checked.
T}
T{
/r
T}@T{
Locates bad sectors and recovers readable information.
The disk must be locked.
\f[B]/r\f[R] includes the functionality of \f[B]/f\f[R], with the
additional analysis of physical disk errors.
T}
T{
/x
T}@T{
Forces the volume to dismount first, if necessary.
All open handles to the drive are invalidated.
\f[B]/x\f[R] also includes the functionality of \f[B]/f\f[R].
T}
T{
/i
T}@T{
Use with NTFS only.
Performs a less vigorous check of index entries, which reduces the
amount of time required to run \f[B]chkdsk\f[R].
T}
T{
/c
T}@T{
Use with NTFS only.
Does not check cycles within the folder structure, which reduces the
amount of time required to run \f[B]chkdsk\f[R].
T}
T{
/l[:\f[C]<size>\f[R]]
T}@T{
Use with NTFS only.
Changes the log file size to the size you type.
If you omit the size parameter, \f[B]/l\f[R] displays the current size.
T}
T{
/b
T}@T{
Use with NTFS only.
Clears the list of bad clusters on the volume and rescans all allocated
and free clusters for errors.
\f[B]/b\f[R] includes the functionality of \f[B]/r\f[R].
Use this parameter after imaging a volume to a new hard disk drive.
T}
T{
/scan
T}@T{
Use with NTFS only.
Runs an online scan on the volume.
T}
T{
/forceofflinefix
T}@T{
Use with NTFS only (must be used with \f[B]/scan\f[R]).
Bypass all online repair; all defects found are queued for offline
repair (for example, \f[C]chkdsk /spotfix\f[R]).
T}
T{
/perf
T}@T{
Use with NTFS only (must be used with \f[B]/scan\f[R]).
Uses more system resources to complete a scan as fast as possible.
This may have a negative performance impact on other tasks running on
the system.
T}
T{
/spotfix
T}@T{
Use with NTFS only.
Runs spot fixing on the volume.
T}
T{
/sdcleanup
T}@T{
Use with NTFS only.
Garbage collect unneeded security descriptor data (implies
\f[B]/f\f[R]).
T}
T{
/offlinescanandfix
T}@T{
Runs an offline scan and fix on the volume.
T}
T{
/freeorphanedchains
T}@T{
Use with FAT/FAT32/exFAT only.
Frees any orphaned cluster chains instead of recovering their contents.
T}
T{
/markclean
T}@T{
Use with FAT/FAT32/exFAT only.
Marks the volume clean if no corruption was detected, even if
\f[B]/f\f[R] was not specified.
T}
T{
/?
T}@T{
Displays help at the command prompt.
T}
.TE
.SS Remarks
.IP \[bu] 2
The \f[B]/i\f[R] or \f[B]/c\f[R] switch reduces the amount of time
required to run \f[B]chkdsk\f[R] by skipping certain volume checks.
.IP \[bu] 2
If you want \f[B]chkdsk\f[R] to correct disk errors, you can\[cq]t have
open files on the drive.
If files are open, the following error message appears:
.RS 2
.IP
.nf
\f[C]
Chkdsk cannot run because the volume is in use by another process. Would you like to schedule this volume to be checked the next time the system restarts? (Y/N)
\f[R]
.fi
.RE
.IP \[bu] 2
If you choose to check the drive the next time you restart the computer,
\f[B]chkdsk\f[R] checks the drive and corrects errors automatically when
you restart the computer.
If the drive partition is a boot partition, \f[B]chkdsk\f[R]
automatically restarts the computer after it checks the drive.
.IP \[bu] 2
You can also use the \f[C]chkntfs /c\f[R] command to schedule the volume
to be checked the next time the computer is restarted.
Use the \f[C]fsutil dirty set\f[R] command to set the volume\[cq]s dirty
bit (indicating corruption), so that Windows runs \f[B]chkdsk\f[R] when
the computer is restarted.
.IP \[bu] 2
You should use \f[B]chkdsk\f[R] occasionally on FAT and NTFS file
systems to check for disk errors.
\f[B]Chkdsk\f[R] examines disk space and disk use and provides a status
report specific to each file system.
The status report shows errors found in the file system.
If you run \f[B]chkdsk\f[R] without the \f[B]/f\f[R] parameter on an
active partition, it might report spurious errors because it cannot lock
the drive.
.IP \[bu] 2
\f[B]Chkdsk\f[R] corrects logical disk errors only if you specify the
\f[B]/f\f[R] parameter.
\f[B]Chkdsk\f[R] must be able to lock the drive to correct errors.
.RS 2
.PP
Because repairs on FAT file systems usually change a disk\[cq]s file
allocation table and sometimes cause a loss of data, \f[B]chkdsk\f[R]
might display a confirmation message similar to the following:
.IP
.nf
\f[C]
10 lost allocation units found in 3 chains.
Convert lost chains to files?
\f[R]
.fi
.IP \[bu] 2
If you press \f[B]Y\f[R], Windows saves each lost chain in the root
directory as a file with a name in the format File\f[C]<nnnn>\f[R].chk.
When \f[B]chkdsk\f[R] finishes, you can check these files to see if they
contain any data you need.
.IP \[bu] 2
If you press \f[B]N\f[R], Windows fixes the disk, but it does not save
the contents of the lost allocation units.
.RE
.IP \[bu] 2
If you don\[cq]t use the \f[B]/f\f[R] parameter, \f[B]chkdsk\f[R]
displays a message that the file needs to be fixed, but it does not fix
any errors.
.IP \[bu] 2
If you use \f[C]chkdsk /f*\f[R] on a very large disk or a disk with a
very large number of files (for example, millions of files),
\f[C]chkdsk /f\f[R] might take a long time to complete.
.IP \[bu] 2
Use the \f[B]/r\f[R] parameter to find physical disk errors in the file
system and attempt to recover data from any affected disk sectors.
.IP \[bu] 2
If you specify the \f[B]/f\f[R] parameter, \f[B]chkdsk\f[R] displays an
error message if there are open files on the disk.
If you do not specify the \f[B]/f\f[R] parameter and open files exist,
\f[B]chkdsk\f[R] might report lost allocation units on the disk.
This could happen if open files have not yet been recorded in the file
allocation table.
If \f[B]chkdsk\f[R] reports the loss of a large number of allocation
units, consider repairing the disk.
.IP \[bu] 2
Because the Shadow Copies for Shared Folders source volume cannot be
locked while \f[B]Shadow Copies for Shared Folders\f[R] is enabled,
running \f[B]chkdsk\f[R] against the source volume might report false
errors or cause \f[B]chkdsk\f[R] to unexpectedly quit.
You can, however, check shadow copies for errors by running
\f[B]chkdsk\f[R] in Read-only mode (without parameters) to check the
Shadow Copies for Shared Folders storage volume.
.IP \[bu] 2
The \f[B]chkdsk\f[R] command, with different parameters, is available
from the Recovery Console.
.IP \[bu] 2
On servers that are infrequently restarted, you may want to use the
\f[B]chkntfs\f[R] or the \f[C]fsutil dirty query\f[R] commands to
determine whether the volume\[cq]s dirty bit is already set before
running chkdsk.
.SS Understanding exit codes
.PP
The following table lists the exit codes that \f[B]chkdsk\f[R] reports
after it has finished.
.PP
.TS
tab(@);
lw(31.5n) lw(38.5n).
T{
Exit code
T}@T{
Description
T}
_
T{
0
T}@T{
No errors were found.
T}
T{
1
T}@T{
Errors were found and fixed.
T}
T{
2
T}@T{
Performed disk cleanup (such as garbage collection) or did not perform
cleanup because \f[B]/f\f[R] was not specified.
T}
T{
3
T}@T{
Could not check the disk, errors could not be fixed, or errors were not
fixed because \f[B]/f\f[R] was not specified.
T}
.TE
.SS Examples
.PP
To check the disk in drive D and have Windows fix errors, type:
.IP
.nf
\f[C]
chkdsk d: /f
\f[R]
.fi
.PP
If it encounters errors, \f[B]chkdsk\f[R] pauses and displays messages.
\f[B]Chkdsk\f[R] finishes by displaying a report that lists the status
of the disk.
You cannot open any files on the specified drive until \f[B]chkdsk\f[R]
finishes.
.PP
To check all files on a FAT disk in the current directory for
noncontiguous blocks, type:
.IP
.nf
\f[C]
chkdsk *.*
\f[R]
.fi
.PP
\f[B]Chkdsk\f[R] displays a status report, and then lists the files that
match the file specifications that have noncontiguous blocks.
.SS Additional References
.IP \[bu] 2
Command-Line Syntax Key
.SH AUTHORS
jasongerend.
